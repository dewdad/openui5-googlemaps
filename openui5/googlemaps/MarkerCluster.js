sap.ui.define(["jquery.sap.global","sap/ui/core/Control","google.maps","./markerclusterer"],function(e,t,r,s){"use strict";s=window.MarkerClusterer;var o=t.extend("openui5.googlemaps.MarkerCluster",{metadata:{properties:{averageCenter:{type:"boolean",bindable:"bindable",defaultValue:!0}},defaultAggregation:"markers",aggregations:{markers:{type:"openui5.googlemaps.Marker",multiple:!0,bindable:"bindable"}},events:{click:{},mouseover:{},mouseout:{}},renderer:{}}}),i=null;o.prototype.init=function(){this.aListeners=[]},o.prototype.onMapRendered=function(e){this.map=e,this.setClusterer()},o.prototype.onClusterClick=function(e){this.fireClick({cluster:e})},o.prototype.onClusterMouseover=function(e){this.fireMouseover({cluster:e})},o.prototype.onClusterMouseout=function(e){this.fireMouseout({cluster:e})},o.prototype._getMarkers=function(){var e=this,t=[];return this.getMarkers().forEach(function(r){r.setMarker(),r.setMap(e.map),t.push(r.marker)}),t},o.prototype.getOptions=function(){var e={};if(null===i)try{i=/CompositeMarker$/.test(this.mBindingInfos.markers.template.getMetadata()._sClassName)}catch(t){i=!1}return i&&(e.calculator=n),e.averageCenter=this.getAverageCenter(),e},o.prototype.setClusterer=function(){this.markerClusterer=new s(this.map,this._getMarkers(),this.getOptions()),this.addListener("click",e.proxy(this.onClusterClick,this)),this.addListener("mouseover",e.proxy(this.onClusterMouseover,this)),this.addListener("mouseout",e.proxy(this.onClusterMouseout,this))},o.prototype.addListener=function(e,t){this.aListeners.push(r.event.addListener(this.markerClusterer,e,t))},o.prototype.removeListeners=function(){this.aListeners.forEach(function(e){e.remove()}),this.aListeners=[]},o.prototype.reset=function(){this.markerClusterer&&(this.removeListeners(),this.markerClusterer=void 0)},o.prototype.onReset=function(){this.reset()},o.prototype.exit=function(){this.reset()};var n=function(e,t){for(var r=0,s="",o=e.length,i=0;i<e.length;i++){var n=e[i];n.get("count")>1&&(o+=n.get("count")-1)}return r=Math.min(o.toString().length,t),console.log({clusterSize:o,numStyles:t,index:r}),{text:o,index:r,title:s}};return o},!0);